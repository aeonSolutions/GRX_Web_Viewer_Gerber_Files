(this.webpackJsonpgrx=this.webpackJsonpgrx||[]).push([[0],{117:function(e,t,n){n(200).config(),e.exports={backendurl:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GRX_API||"https://grx.creery.org",port:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GRX_APIPORT||"/api"}},170:function(e){e.exports=JSON.parse('{"a":"1.0.1"}')},223:function(e,t,n){},341:function(e,t,n){},342:function(e,t,n){},343:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(34),o=n.n(c),i=n(5),s=n(9),l=n(7),d=n(8),u=(n(223),n(30)),b=n(32),h=n.n(b),p=n(47),j=n(104),f=n(172),x=n(356),m=n(353),y=n(215),v=n(52),g=n(359),O=n(209),S=n(352),w=n(96),C=n(60),k=n(349),E=n(350),D=n(360),L=n(54),B=n(146),A=n(365),T=n(218),P=n(36),I=n(354),z=n(361),R=n(10),F=function(){var e,t=Object(r.useContext)(De).rendercontainer;t&&(e=getComputedStyle(t).getPropertyValue("--svg-scale"));var n=Object(r.useState)(e),a=Object(P.a)(n,2),c=a[0],o=a[1];return Object(R.jsxs)(w.a,{style:{margin:"5px "},children:[Object(R.jsx)(C.a,{flex:"30px",style:{padding:"5px"},children:Object(R.jsx)(z.a,{})}),Object(R.jsx)(C.a,{flex:"auto",children:Object(R.jsx)(I.a,{min:1,max:10,onChange:function(e){return function(e){t.style.setProperty("--svg-scale",e),o(e)}(e)},value:c})})]})},N=n(348),H=n(357),_=n(358),V=n(53),M=n(362),W=n(138),G=function(e){var t=Object(r.useState)(e.layer.visible),n=Object(P.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)("#FFFFFF"),i=Object(P.a)(o,2),s=i[0],l=i[1];return Object(r.useEffect)((function(){var t=document.getElementById(e.layer.name);!function n(){null!==t?l(getComputedStyle(t).getPropertyValue("color")):(t=document.getElementById(e.layer.name),setTimeout(n,250))}()}),[e.layer.name]),Object(R.jsx)("div",{style:{width:"100%"},children:Object(R.jsxs)(w.a,{wrap:!1,children:[Object(R.jsx)(C.a,{flex:"10px",children:Object(R.jsx)(N.a,{content:Object(R.jsx)(W.a,{color:s,onChange:function(t,n){return function(t,n){document.getElementById(e.layer.name).style.color="rgba(".concat(t.rgb.r,", ").concat(t.rgb.g,", ").concat(t.rgb.b,", 0.7)"),l(t.hex)}(t)}}),title:Object(R.jsxs)("div",{children:[Object(R.jsx)(M.a,{}),"\xa0 ColorPicker"]}),placement:"right",trigger:"click",children:Object(R.jsx)(H.a,{color:s})})}),Object(R.jsx)(C.a,{flex:"auto",children:Object(R.jsx)(_.a,{style:{whiteSpace:"pre"},checked:a,onChange:function(t){return function(t){console.log(t),e.layer.visible=t,c(t)}(t.target.checked)},children:Object(R.jsx)(V.a,{placement:"right",title:e.layer.name,children:e.layer.name})})})]})})},J=n(93),K=function(e){var t=e.layer,n=e.add,a=e.remove,c=e.fetchLayer,o=Object(r.useState)(e.layer.visible),i=Object(P.a)(o,2),s=i[0],l=i[1],d=Object(r.useState)("#FFFFFF"),u=Object(P.a)(d,2),b=u[0],j=u[1],f=function(){var r=Object(p.a)(h.a.mark((function r(o){var i,s;return h.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=document.getElementById(t.name),console.log(i),console.log(t),!0!==o){r.next=10;break}return r.next=6,c(t);case 6:s=r.sent,n.apply(void 0,Object(J.a)(s).concat([i])),r.next=11;break;case 10:!1===o&&a(t);case 11:e.layer.visible=o,l(o);case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return Object(r.useEffect)((function(){console.log("Effect"),console.log(t.name);var e=document.getElementById(t.name);!function n(){null!==e?j(getComputedStyle(e).getPropertyValue("color")):(e=document.getElementById(t.name),setTimeout(n,250))}()}),[e.layer.name]),Object(R.jsx)("div",{style:{width:"100%"},children:Object(R.jsxs)(w.a,{wrap:!1,children:[Object(R.jsx)(C.a,{flex:"10px",children:Object(R.jsx)(N.a,{content:Object(R.jsx)(W.a,{color:b,onChange:function(e,n){return function(e,n){document.getElementById(t.name).style.color="rgba(".concat(e.rgb.r,", ").concat(e.rgb.g,", ").concat(e.rgb.b,", 0.7)"),j(e.hex)}(e)}}),title:Object(R.jsxs)("div",{children:[Object(R.jsx)(M.a,{}),"\xa0 ColorPicker"]}),placement:"right",trigger:"click",children:Object(R.jsx)(H.a,{color:b})})}),Object(R.jsx)(C.a,{flex:"auto",children:Object(R.jsx)(_.a,{style:{whiteSpace:"pre"},checked:s,onChange:function(e){return f(e.target.checked)},children:Object(R.jsx)(V.a,{placement:"right",title:t.name,children:t.name})})})]})})},U=function(){var e=Object(r.useContext)(De).rendercontainer,t=Object(r.useState)(!1),n=Object(P.a)(t,2),a=n[0],c=n[1];return Object(R.jsxs)(w.a,{style:{margin:"5px "},children:[Object(R.jsx)(C.a,{flex:"auto",style:{padding:"5px"},children:"Color Blend"}),Object(R.jsx)(C.a,{flex:"30px",style:{padding:"5px"},children:Object(R.jsx)(D.a,{size:"small",checked:a,onChange:function(t){return function(t){t?e.style.setProperty("--blend-mode","color"):e.style.setProperty("--blend-mode","normal"),c(t)}(t)}})})]})},X=n(355),Y=n(103),q=n(351),Q=n(363),Z=n(364),$=q.a.Dragger,ee=n(117),te=ee.backendurl,ne=ee.port,re=function(e){console.log(e.job);var t=e.job,n=Object(r.useState)([]),a=Object(P.a)(n,2),c=a[0],o=a[1],i=Object(r.useState)(!1),s=Object(P.a)(i,2),l=s[0],d=s[1];Object(r.useEffect)((function(){return u(),function(){}}),[]);var u=function(){var e=Object(p.a)(h.a.mark((function e(){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!0),e.next=3,fetch("".concat(te).concat(ne,"/uploaded?job=").concat(t));case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,a=r.map((function(e){return{uid:e,name:e,status:"done"}})),o(a),d(!1),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(p.a)(h.a.mark((function e(n){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(n),e.prev=1,e.next=4,fetch("".concat(te).concat(ne,"/file?job=").concat(t,"&filename=").concat(n.name),{method:"DELETE"});case 4:r=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),e.t0;case 10:return e.abrupt("return",new Promise((function(e,t){try{var n;if(200!==r.status)throw console.error(r),r.text();e(r)}catch(n){t(n)}})));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),j={action:"".concat(te).concat(ne,"/upload?job=").concat(t),onChange:function(e){console.log(e);var t=Object(J.a)(e.fileList);t=t.map((function(e){return e.response&&(console.log(e.url),e.url=e.response.url),e})),o(t)},onRemove:b,multiple:!0};return Object(R.jsxs)("div",{children:[Object(R.jsxs)($,Object(Y.a)(Object(Y.a)({},j),{},{fileList:c,children:[Object(R.jsx)("p",{children:Object(R.jsx)(Q.a,{style:{fontSize:"32px"}})}),Object(R.jsx)("p",{children:"Drag Gerber Files Here"}),Object(R.jsx)("p",{children:"(or click to open directory)"})]})),Object(R.jsx)("div",{style:{textAlign:"right"},children:Object(R.jsx)(v.a,{loading:l,type:"text",icon:Object(R.jsx)(Z.a,{style:{fontSize:"15px"}}),onClick:function(){return u()},children:"Reload"})})]})},ae=n(117),ce=(ae.backendurl,ae.port,function(e){var t=e.replaceArtwork,n=e.job,a=Object(r.useState)(!1),c=Object(P.a)(a,2),o=c[0],i=c[1];Object(r.useEffect)((function(){return function(){}}),[n]);return Object(R.jsxs)("div",{children:[Object(R.jsx)(v.a,{type:"text",size:"small",onClick:function(){i(!0)},children:"Upload"}),Object(R.jsx)(X.a,{title:"Import Gerbers into Job: ".concat(n),visible:o,onOk:function(e){console.log(e),i(!1),t(n)},onCancel:function(e){console.log(e),i(!1)},destroyOnClose:!0,keyboard:!0,children:Object(R.jsx)(re,{job:n})})]})}),oe=n(117),ie=oe.backendurl,se=oe.port,le=function(e){var t=e.replaceArtwork,n=e.update,a=Object(r.useState)(!1),c=Object(P.a)(a,2),o=c[0],i=c[1],s=Object(r.useState)(null),l=Object(P.a)(s,2),d=l[0],u=l[1],b=Object(r.useState)(!0),j=Object(P.a)(b,2),f=j[0],m=j[1],g=function(){var e=Object(p.a)(h.a.mark((function e(r){var a,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=d&&""!=d){e.next=3;break}return y.b.warning("Must Assign your job a name"),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("".concat(ie).concat(se,"/job?job=").concat(d),{method:"POST"});case 6:if(200===(a=e.sent).status){e.next=14;break}return e.next=10,a.text();case 10:c=e.sent,console.log(c);try{o=JSON.parse(c),c=o.Message}catch(r){}throw c;case 14:e.next=21;break;case 16:return e.prev=16,e.t0=e.catch(3),console.error(e.t0),y.b.error(e.t0),e.abrupt("return");case 21:i(!1),n(),t(d);case 24:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(R.jsxs)("div",{children:[Object(R.jsx)(v.a,{type:"text",size:"small",onClick:function(){i(!0)},children:"Create"}),Object(R.jsx)(X.a,{title:"Create New Job",visible:o,onOk:g,onCancel:function(e){i(!1)},okButtonProps:{disabled:f},keyboard:!0,children:Object(R.jsx)(x.a,{placeholder:"enter job name",onChange:function(e){u(e.target.value),m(!1)},onPressEnter:function(){return g()}})})]})},de=n(136),ue=n.n(de),be=m.a.Text,he=function(e){var t,n=Object(r.useContext)(De),a=n.drawContainer,c=n.drawBoardSize,o=n.drawBoardScale,i=function(e,t){var n={pixel:{x:0,y:0},inch:{x:0,y:0},mm:{x:0,y:0},draw:{x:0,y:0}};n.pixel.x=(e.offsetX-c/2)*o,n.pixel.y=-(e.offsetY-c/2)*o,n.inch.x=n.pixel.x/96,n.inch.y=n.pixel.y/96,n.mm.x=24*n.inch.x,n.mm.y=24*n.inch.y,n.draw.x=e.offsetX,n.draw.y=e.offsetY,t(n)},s=function(){a.innerHTML="";var e=ue()(a.id).size(c,c),t=a.childNodes[0];return t.style.top="-".concat(c/2,"px"),t.style.left="-".concat(c/2,"px"),t.style.position="relative",t.style.transformOrigin="center",t.style.transform="scale(".concat(o,")"),t.style.cursor="crosshair",t.style.filter="drop-shadow(2px 4px 6px black)",e},l=function(){t=s();var e=function(e){return i(e,d)};a.addEventListener("click",e,{once:!0});document.addEventListener("keydown",(function(t){"Escape"==t.key&&(console.log(t),a.removeEventListener("click",e),s())}),{once:!0})},d=function(e){var n=e,r=t.line(e.draw.x,e.draw.y,e.draw.x,e.draw.y).stroke({color:"white",width:3,linecap:"round"}),c=t.text("DX:0 DY:0 D:0").click((function(e){return console.log(e)}));c.font({fill:"white",family:"Inconsolata",size:50});var o=function(e){i(e,(function(e){r.attr({x2:e.draw.x,y2:e.draw.y}),c.move(e.draw.x,e.draw.y).text("DX:".concat((e.inch.x-n.inch.x).toFixed(5),'" DY:').concat((e.inch.y-n.inch.y).toFixed(5),'" D:').concat(Math.sqrt(Math.pow(e.inch.x-n.inch.x,2)+Math.pow(e.inch.y-n.inch.y,2)).toFixed(5),'"'))}))};a.addEventListener("mousemove",o),a.addEventListener("click",(function(e){a.removeEventListener("mousemove",o)}))},u=function(e){console.log(e),e.altKey&&"KeyR"===e.code&&l()};return Object(r.useEffect)((function(){return document.addEventListener("keydown",u,!1),function(){document.removeEventListener("keydown",u,!1)}})),Object(R.jsx)("div",{children:Object(R.jsxs)(v.a,{type:"text",style:{width:"100%"},onClick:function(){return l()},children:["Ruler\xa0",Object(R.jsx)(be,{type:"secondary",children:"(alt+r)"})]})})},pe=m.a.Text,je=function(e){var t=Object(r.useContext)(De),n=t.drawContainer,a=(t.drawBoardSize,t.drawBoardScale,t.svgContainer),c=function(){var e=n.childNodes[0];n.removeChild(e);var t,r=a.querySelector("div > svg"),c=r.querySelectorAll("defs > *"),o=r.querySelectorAll("g > *"),i=r.getAttribute("width").slice(-2),s=r.cloneNode(!0),l=[];c.forEach((function(e){l.push({id:e.id,type:e.nodeName,attributes:e.attributes})})),console.log(l),o.forEach((function(e){var n;t=e.style.color,e.onmouseover=function(e){if(e.target.style.color="#08979c","path"==e.target.nodeName)n={type:e.target.nodeName,g:"path",lineWidth:e.target.attributes["stroke-width"]?e.target.attributes["stroke-width"].value:0,code:e.target.attributes.d.value,attr:e.target.attributes};else if("use"==e.target.nodeName){var t=l.find((function(t){return t.id==e.target.attributes["xlink:href"].value.substring(1)}));n={type:e.target.nodeName,g:"pad",x:e.target.attributes.x.value,y:e.target.attributes.y.value,shapeid:e.target.attributes["xlink:href"].value,shape:t,attr:e.target.attributes}}var r=document.getElementById("bottom-info-bar"),a=r.childNodes[0],c=document.createElement("h4");c.innerHTML=n?"path"==n.g?"0"==n.lineWidth?"SURFACE":"LINE | Width: ".concat(n.lineWidth/1e3).concat(i):"PAD | Shape: ".concat("g"==n.shape.type?"SPECIAL | X: ".concat((n.x/1e3).toFixed(5)).concat(i," Y: ").concat((n.y/1e3).toFixed(5)).concat(i):"".concat(n.shape.type.toUpperCase(),"  | X: ").concat((n.x/1e3).toFixed(5)).concat(i," Y: ").concat((n.y/1e3).toFixed(5)).concat(i," | ").concat(function(e,t){for(var n=Object(J.a)(e),r="",a=0;a<n.length;a++)"id"!=n[a].nodeName&&(r+=" ".concat(n[a].nodeName.toUpperCase(),": ").concat((n[a].value/1e3).toFixed(5)).concat(t));return r}(n.shape.attributes,i))):"NA",n&&r.replaceChild(c,a)},e.onmouseleave=function(e){e.target.style.color=t}}));document.addEventListener("keydown",(function(t){"Escape"==t.key&&(n.appendChild(e),r.parentNode.replaceChild(s,r))}),{once:!0})},o=function(e){e.altKey&&"KeyS"===e.code&&c()};return Object(r.useEffect)((function(){return document.addEventListener("keydown",o,!1),function(){document.removeEventListener("keydown",o,!1)}})),Object(R.jsx)("div",{children:Object(R.jsxs)(v.a,{type:"text",style:{width:"100%"},onClick:function(){return c()},children:["Select\xa0",Object(R.jsx)(pe,{type:"secondary",children:"(alt+s)"})]})})},fe=j.a.Option,xe=(j.a.OptGroup,f.a.TabPane),me=x.a.Search,ye=(m.a.Text,m.a.Link,n(117)),ve=ye.backendurl,ge=ye.port,Oe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).fetchData=function(){var e=Object(p.a)(h.a.mark((function e(t,n){var a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0,percent:0}),e.prev=1,e.next=4,fetch(ve+ge+t,{method:n||"GET"});case 4:if(200===(a=e.sent).status){e.next=11;break}return console.error(a),e.next=9,a.text();case 9:throw e.sent;case 11:return e.next=13,a.json();case 13:return c=e.sent,r.setState({loading:!1,percent:100}),e.abrupt("return",c);case 18:throw e.prev=18,e.t0=e.catch(1),r.setState({loading:!1}),y.b.error("Error => "+e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t,n){return e.apply(this,arguments)}}(),r.fetchLayer=function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("front"===t.name||"back"===t.name){e.next=6;break}return e.next=3,r.fetchData("/gbr2svg/getLayerArtwork?job=".concat(r.state.job,"&layer=").concat(t.name));case 3:n=e.sent,e.next=10;break;case 6:return e.next=8,r.fetchData("/gbr2svg/getFinishedArtwork?job=".concat(r.state.job,"&outline=").concat(r.state.useoutline));case 8:n=e.sent,n=Array(n.find((function(e){return e.name==t.name})));case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.replaceArtwork=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Getting Finished Artowrk for",t),!0!==r.state.frontload){e.next=11;break}return e.next=4,r.fetchData("/gbr2svg/getLayerArtwork?job=".concat(t));case 4:return n=e.sent,e.next=7,r.fetchData("/gbr2svg/getFinishedArtwork?job=".concat(t,"&outline=").concat(r.state.useoutline));case 7:a=e.sent,r.props.setJob(t,n,a),e.next=17;break;case 11:if(!1!==r.state.frontload){e.next=17;break}return e.next=14,r.getLayerList(t);case 14:n=e.sent,a=[{name:"front",type:"finished",side:"top",svg:""},{name:"back",type:"finished",side:"bottom",svg:""}],r.props.setJob(t,n,a);case 17:return e.abrupt("return");case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.changeDOMSVG=function(e,t){r.removeDOMSVG(e),document.getElementById(e).innerHTML=t},r.addDOMSVG=function(e,t){document.getElementById(e).innerHTML=t},r.removeDOMSVG=function(e){document.getElementById(e).innerHTML=""},r.getJobList=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fetchData("/joblist?search=".concat(t));case 2:return n=e.sent,a=n.Jobs.map((function(e){return e.Name})),r.setState({jobList:a}),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.getLayerList=function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fetchData("/gbr2svg/getLayerList?job=".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleJobDelete=function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,r.fetchData("/job?job=".concat(t),"DELETE");case 3:return n=e.sent,r.getJobList(""),console.log(n),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handleFrontLoad=function(e){!0===e&&r.replaceArtwork(r.state.job),r.setState({frontload:e})},r.handleUseOutline=function(e){r.setState({useoutline:e})},r.hideSidebar=function(){r.setState({sidebarhidden:!0,sidebar:"sidebar-hidden"})},r.showSidebar=function(){r.setState({sidebarhidden:!1,sidebar:"sidebar"})},r.state={job:null,layers:[],rendered:null,loading:!1,percent:0,jobList:[],sidebarhidden:!1,sidebar:"sidebar",frontload:!1,useoutline:!0,objectSelection:null,coordinatesActive:!1},r}return Object(s.a)(n,[{key:"render",value:function(){var e=this;return Object(R.jsxs)("div",{style:{padding:"10px",width:"200px",height:"100%"},children:[Object(R.jsx)(v.a,{type:"text",className:"togglesidebar",hidden:this.state.sidebarhidden,onClick:function(){return e.hideSidebar()},children:"HIDE"}),Object(R.jsx)(v.a,{type:"text",className:"togglesidebar",hidden:!this.state.sidebarhidden,onClick:function(){return e.showSidebar()},children:"SHOW"}),Object(R.jsx)(T.a,{style:{padding:0},defaultSize:{height:"100%",width:"200px"},enable:{top:!1,right:!0,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},maxWidth:"400px",minWidth:"200px",children:Object(R.jsx)(g.a,{style:{backgroundColor:"rgba(30, 30, 30, 0.85)",backdropFilter:"blur(25px)",height:"100%",width:"-webkit-fill-available",transition:"0.5s ease",pointerEvents:"all"},bodyStyle:{height:"calc(100% - 100px)",padding:"0px"},title:this.state.loading?Object(R.jsx)(O.a,{indicator:Object(R.jsx)(L.a,{spin:!0})}):this.state.job||"GRX Gerber Renderer",className:this.state.sidebar,children:Object(R.jsxs)(f.a,{animated:{inkBar:!0,tabPane:!0},size:"small",defaultActiveKey:"1",onChange:function(e){return console.log(e)},centered:!0,children:[Object(R.jsxs)(xe,{tab:"Jobs",children:[Object(R.jsx)(me,{placeholder:"input search",onSearch:function(t){return e.getJobList(t)},style:{width:"-webkit-fill-available"}}),Object(R.jsx)("div",{style:Object(u.a)({height:"100%",position:"relative",overflowX:"hidden",overflowY:"scroll"},"height","100%"),children:Object(R.jsx)(S.b,{size:"small",header:Object(R.jsxs)(w.a,{style:{margin:"0px"},children:[Object(R.jsx)(C.a,{span:15,style:{padding:"0px 10px"},children:Object(R.jsx)("div",{children:"Job List"})}),Object(R.jsx)(C.a,{span:9,style:{padding:"0px",textAlign:"right"},children:Object(R.jsx)(le,{replaceArtwork:function(t){return e.replaceArtwork(t)},update:function(){return e.getJobList("")}})})]}),dataSource:this.state.jobList,renderItem:function(t){return Object(R.jsxs)(S.b.Item,{style:{padding:"5px 5px"},children:[Object(R.jsx)(v.a,{type:"link",style:{width:"90%",height:"27px"},onClick:function(){return e.replaceArtwork(t)},children:t}),Object(R.jsx)(k.a,{title:"Are you sure delete this job?",onConfirm:function(){return e.handleJobDelete(t)},okText:"Yes",cancelText:"No",children:Object(R.jsx)(B.a,{})})]})}})})]},"1"),Object(R.jsx)(xe,{tab:"Layers",style:{overflowX:"hidden",overflowY:"scroll",height:"100%"},children:Object(R.jsx)(S.b,{size:"small",header:Object(R.jsxs)(w.a,{style:{margin:"0px"},children:[Object(R.jsx)(C.a,{span:15,style:{padding:"0px 10px"},children:Object(R.jsx)("div",{children:"Layers"})}),Object(R.jsx)(C.a,{span:9,style:{padding:"0px",textAlign:"right"},children:Object(R.jsx)(ce,{replaceArtwork:function(t){return e.replaceArtwork(t)},job:this.state.job})})]}),dataSource:this.state.layers,renderItem:function(t){return Object(R.jsx)(S.b.Item,{style:{padding:"8px 8px"},children:e.state.frontload?Object(R.jsx)(G,{layer:t},t):Object(R.jsx)(K,{layer:t,add:function(){var t;return(t=e.props).setSVGinDIV.apply(t,arguments)},remove:function(){var t;return(t=e.props).removeSVGinDIV.apply(t,arguments)},fetchLayer:function(){return e.fetchLayer.apply(e,arguments)}},t)})}})},"2"),Object(R.jsxs)(xe,{tab:"Tools",forceRender:!0,style:{overflowX:"hidden",overflowY:"scroll",height:"100%"},children:[Object(R.jsx)(E.a,{plain:!0,children:"Kit"}),Object(R.jsx)(je,{}),Object(R.jsx)(he,{}),Object(R.jsx)(E.a,{plain:!0,children:"Settings"}),Object(R.jsxs)(w.a,{style:{margin:"5px "},children:[Object(R.jsx)(C.a,{flex:"30px",style:{padding:"5px"},children:Object(R.jsx)(A.a,{})}),Object(R.jsx)(C.a,{flex:"auto",children:Object(R.jsxs)(j.a,{defaultValue:"orthographic",onChange:function(t){return e.props.cameraSelector(t)},style:{width:"100%"},children:[Object(R.jsx)(fe,{value:"perspective",children:"Perspective"}),Object(R.jsx)(fe,{value:"orthographic",children:"Orthographic"})]})})]}),Object(R.jsx)(F,{}),Object(R.jsx)(U,{}),Object(R.jsxs)(w.a,{style:{margin:"5px "},children:[Object(R.jsx)(C.a,{flex:"auto",style:{padding:"5px"},children:"Front Load"}),Object(R.jsx)(C.a,{flex:"30px",style:{padding:"5px"},children:Object(R.jsx)(D.a,{size:"small",checked:this.state.frontload,onChange:function(t){return e.handleFrontLoad(t)}})})]}),Object(R.jsxs)(w.a,{style:{margin:"5px "},children:[Object(R.jsx)(C.a,{flex:"auto",style:{padding:"5px"},children:"Use Outline"}),Object(R.jsx)(C.a,{flex:"30px",style:{padding:"5px"},children:Object(R.jsx)(D.a,{size:"small",checked:this.state.useoutline,onChange:function(t){return e.handleUseOutline(t)}})})]})]},"3")]})})})]})}},{key:"componentDidMount",value:function(){this.getJobList("")}},{key:"componentDidUpdate",value:function(){console.log("updated")}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n={};return console.log(t,e),e.job!==t.job||e.layers!==t.layers?(n.job=e.job,n.layers=e.layers,n):null}}]),n}(r.Component),Se=n(27),we=n(169),Ce=n(107),ke=n(211),Ee=function(e){var t=Object(r.useState)({pixel:{x:0,y:0},inch:{x:0,y:0},mm:{x:0,y:0},draw:{x:0,y:0}}),n=Object(P.a)(t,2),a=n[0],c=n[1],o=Object(r.useContext)(De),i=o.drawContainer,s=o.drawBoardSize,l=o.drawBoardScale,d=o.infobar,u=function(e){var t=d.childNodes[0],n={pixel:{x:0,y:0},inch:{x:0,y:0},mm:{x:0,y:0},draw:{x:0,y:0}};n.pixel.x=(e.offsetX-s/2)*l,n.pixel.y=-(e.offsetY-s/2)*l,n.inch.x=n.pixel.x/96,n.inch.y=n.pixel.y/96,n.mm.x=24*n.inch.x,n.mm.y=24*n.inch.y,n.draw.x=e.offsetX,n.draw.y=-e.offsetY;var r=document.createElement("h4");r.innerHTML="( ".concat(a.inch.x.toFixed(5),"in, ").concat(a.inch.y.toFixed(5),"in )"),d.replaceChild(r,t),c(n)};return Object(r.useEffect)((function(){return function(){null===i||void 0===i||i.removeEventListener("mousemove",u)}})),Object(R.jsx)("div",{})},De=(n(341),a.a.createContext()),Le=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).CSS3DObjects=[],r.addInitSVGFromDom=function(){var e=document.getElementById("front");r.frontPCBObject=new Ce.a(e),r.frontPCBObject.name="front",r.frontPCBObject.position.x=0,r.frontPCBObject.position.y=25,r.frontPCBObject.position.z=1,r.frontPCBObject.context=e.getAttribute("data-context"),r.cssScene.add(r.frontPCBObject);e=document.getElementById("back");r.backPCBObject=new Ce.a(e),r.backPCBObject.name="back",r.backPCBObject.position.x=0,r.backPCBObject.position.y=25,r.backPCBObject.position.z=.5,r.backPCBObject.context=e.getAttribute("data-context"),r.cssScene.add(r.backPCBObject),r.setState({CSS3DObjects:[r.frontPCBObject,r.backPCBObject]})},r.initDrawBoard=function(){if(!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){r.drawContainer=document.createElement("div"),r.drawContainer.id="draw-board",r.drawContainer.style.cssText="position: absolute; width: 0px; height: 0px;",r.drawContainer.style.zIndex="1000",r.drawContainer.setAttribute("data-context","drawing"),r.drawContainer.style.transform="matrix3d(1, 0, 0, 0, 0, -1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1) scale(var(--svg-scale))",r.svgContainer.appendChild(r.drawContainer),r.drawing=ue()(r.drawContainer.id).size(r.drawBoardSize,r.drawBoardSize);var e=r.drawContainer.childNodes[0];e.style.top="-".concat(r.drawBoardSize/2,"px"),e.style.left="-".concat(r.drawBoardSize/2,"px"),e.style.position="relative",e.style.transformOrigin="center",e.style.transform="scale(".concat(r.drawBoardScale,")"),e.style.cursor="crosshair"}},r.setJob=function(e,t,n){r.removeAllLayers(),t.forEach((function(e){r.addLayer(e,!1)})),n.forEach((function(e){r.addLayer(e,!1)})),r.setState({CSS3DObjects:r.cssScene.children,job:e})},r.addLayer=function(e,t){var n=document.createElement("div");n.id=e.name,n.setAttribute("data-type",e.type),n.setAttribute("data-side",e.side),n.setAttribute("data-context","board"),n.style.width="0px",n.style.height="0px",n.style.position="relative",n.style.color="rgb(".concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),", ").concat(Math.floor(256*Math.random()),", 0.7)"),e.svg&&(n=r.setSVGinDIV(e,n)),r.addElementToThree(n,t)},r.setSVGinDIV=function(e,t){t.innerHTML=e.svg;var n=t.childNodes[0],r=n.getAttribute("viewBox"),a=n.getAttribute("width").slice(-2),c=r.split(" "),o=Number(c[0])/1e3,i=Number(c[1])/1e3,s=Number(c[2])/1e3,l=Number(c[3])/1e3;if(t.dataset.width=s,t.dataset.height=l,n.style.position="relative",n.style.transformOrigin="0 0","back"===t.id)n.style.bottom="calc(".concat(l+i).concat(a," * var(--svg-scale))"),n.style.left="calc(".concat(o+s).concat(a," * var(--svg-scale))");else if("front"===t.id){var d=document.createElement("h4");d.className="width-measurement",d.innerHTML="WIDTH: ".concat(s).concat(a),d.style.bottom="calc(".concat(i).concat(a," * var(--svg-scale))"),d.style.left="calc(".concat(o+s).concat(a," * var(--svg-scale))"),t.appendChild(d);var u=document.createElement("h4");u.className="height-measurement",u.innerHTML="HEIGHT: ".concat(l).concat(a),u.style.bottom="calc(".concat(l+i).concat(a," * var(--svg-scale))"),u.style.left="calc(".concat(o).concat(a," * var(--svg-scale))"),t.appendChild(u),n.style.bottom="calc(".concat(l+i).concat(a," * var(--svg-scale))"),n.style.left="calc(".concat(o).concat(a," * var(--svg-scale))")}else n.style.bottom="calc(".concat(l+i).concat(a," * var(--svg-scale))"),n.style.left="calc(".concat(o).concat(a," * var(--svg-scale))");return t},r.removeSVGinDIV=function(e){document.getElementById(e.name).innerHTML=""},r.removeLayer=function(e){r.removeCSS3DObject(e.name)},r.addElementToThree=function(e,t){var n=new Ce.a(e);n.name=e.id,n.visible=t,n.context=e.getAttribute("data-context"),n.position.x=0,n.position.y=0,"back"===n.name?n.position.z=-.5:"front"===n.name&&(n.position.z=.5),r.cssScene.add(n)},r.removeCSS3DObject=function(e){r.cssScene.remove(r.state.CSS3DObjects.find((function(t){return t.name===e}))),r.setState({CSS3DObjects:r.cssScene.children})},r.removeAllCSS3DObjects=function(){for(var e=r.state.CSS3DObjects.length-1;e>=0;e--)r.cssScene.remove(r.state.CSS3DObjects[e]);r.setState({CSS3DObjects:r.cssScene.children})},r.removeAllLayers=function(){for(var e=r.state.CSS3DObjects.filter((function(e){return"board"==e.context})),t=e.length-1;t>=0;t--)r.cssScene.remove(e[t]);r.setState({CSS3DObjects:r.cssScene.children})},r.updateCSSObjects=function(){r.cssScene.children.forEach((function(e){r.cssScene.remove(e)})),r.state.CSS3DObjects.forEach((function(e){r.cssScene.add(e)}))},r.cameraSelector=function(e){"perspective"===e?(r.camera=new Se.g(75,r.rendercontainer.innerWidth/r.rendercontainer.innerHeight,.01,1e3),r.camera.position.z=700,r.controls=new we.a(r.camera,r.cssRenderer.domElement),r.controls.enableRotate=!0,r.controls.zoomSpeed=1,r.setState({cameraType:e})):"orthographic"===e?(r.camera=new Se.f(r.rendercontainer.offsetWidth/-2,r.rendercontainer.offsetWidth/2,r.rendercontainer.offsetHeight/2,r.rendercontainer.offsetHeight/-2,1,1e3),r.camera.position.z=900,r.controls=new we.a(r.camera,r.cssRenderer.domElement),r.controls.enableRotate=!1,r.controls.zoomSpeed=1,r.setState({cameraType:e})):console.log("unkown camera type:",e)},r.setupScene=function(){var e=r.rendercontainer.clientWidth,t=r.rendercontainer.clientHeight;r.cssScene=new Se.i,r.rendercontainer.style.setProperty("--svg-scale","1"),r.cssRenderer=new Ce.b,r.cssRenderer.setSize(e,t),r.cameraSelector("orthographic"),r.rendercontainer.appendChild(r.cssRenderer.domElement),r.cssRenderer.domElement.id="css-renderer",r.svgContainer=r.cssRenderer.domElement.childNodes[0],r.svgContainer.id="svg-container",r.clock=new Se.a,r.stats=new ke.a,r.stats.domElement.style.right="10px",r.stats.domElement.style.left="auto",r.stats.domElement.style.position="absolute",r.stats.domElement.style.zIndex="1002",r.stats.domElement.style.top="10px",r.rendercontainer.appendChild(r.stats.domElement),r.setState({rendered:!0})},r.onWindowResize=function(){r.rendercontainer&&(r.camera.aspect=r.rendercontainer.offsetWidth/r.rendercontainer.offsetHeight,r.camera.updateProjectionMatrix(),r.cssRenderer.setSize(r.rendercontainer.offsetWidth,r.rendercontainer.offsetHeight))},r.animationHandler=function(){r.cssRenderer.render(r.cssScene,r.camera),r.stats.update(),r.controls.update(),requestAnimationFrame(r.animationHandler)},r.state={rendered:null,job:null,CSS3DObjects:[],cameraType:"orthographic",mouseCoordinates:{pixel:{x:0,y:0},inch:{x:0,y:0},mm:{x:0,y:0},draw:{x:0,y:0}}},r.drawBoardSize=1e5,r.drawBoardScale=.1,r.svgContainer=null,r.drawContainer=null,r}return Object(s.a)(n,[{key:"render",value:function(){var e=this;console.log("Rendering Renderer",this.units);var t=this.state.CSS3DObjects.filter((function(e){return"board"==e.context}));return Object(R.jsxs)("div",{id:"main",style:{position:"relative",height:"100%",zIndex:1e3},children:[Object(R.jsxs)(De.Provider,{value:{infobar:this.infobar,rendercontainer:this.rendercontainer,svgContainer:this.svgContainer,drawContainer:this.drawContainer,drawBoardSize:this.drawBoardSize,drawBoardScale:this.drawBoardScale},children:[Object(R.jsx)(Oe,{style:{zIndex:"10"},job:this.state.job,layers:t,svgContainer:this.svgContainer,drawContainer:this.drawContainer,drawBoardSize:this.drawBoardSize,drawBoardScale:this.drawBoardScale,cameraSelector:function(){return e.cameraSelector.apply(e,arguments)},setJob:function(){return e.setJob.apply(e,arguments)},setSVGinDIV:function(t,n){return e.setSVGinDIV(t,n)},removeSVGinDIV:function(t){return e.removeSVGinDIV(t)},clear:function(){return e.removeAllCSS3DObjects()},update:function(){return e.updateCSSObjects()}}),Object(R.jsx)("div",{id:"three",style:{width:"-webkit-fill-available",height:"-webkit-fill-available",position:"absolute",left:0,top:0,zIndex:"-1"},ref:function(t){e.rendercontainer=t}}),Object(R.jsx)(Ee,{})]}),Object(R.jsx)("div",{id:"bottom-info-bar",ref:function(t){e.infobar=t},style:{position:"absolute",width:"-webkit-fill-available",textAlign:"center",bottom:"0px",zIndex:"1000",textShadow:"-1px 0px 2px black, 0 1px 2px black, 1px 0 2px black, 0 -1px 2px black"},children:Object(R.jsx)("h4",{children:"0in, 0in"})})]})}},{key:"componentDidMount",value:function(){this.setupScene(),this.animationHandler(),this.initDrawBoard(),new window.ResizeObserver(this.onWindowResize).observe(this.rendercontainer),this.controls.update()}}]),n}(r.Component),Be=n(170);n(200).config();var Ae=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={windowheight:window.innerHeight},r}return Object(s.a)(n,[{key:"componentDidMount",value:function(){console.log(Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}))}},{key:"render",value:function(){return console.log("Rendering App",Be.a),Object(R.jsxs)("div",{style:{top:0,left:0,height:"100vh",width:"100vw",position:"absolute"},children:[Object(R.jsx)("div",{style:{margin:0,height:"-webkit-fill-available"},children:Object(R.jsx)(Le,{})}),Object(R.jsxs)("div",{className:"icon-attribute",children:[Object(R.jsxs)("h6",{children:["!! DEVELOPMENT v","".concat(Be.a)," !!"]}),Object(R.jsxs)("h6",{children:["Software by"," ",Object(R.jsx)("a",{target:"_blank",href:"https://github.com/hpcreery",children:"Hunter Creery"})," "]})]})]})}}]),n}(r.Component);n(342);o.a.render(Object(R.jsx)(Ae,{}),document.getElementById("root"))}},[[343,1,2]]]);
//# sourceMappingURL=main.f00c9b71.chunk.js.map